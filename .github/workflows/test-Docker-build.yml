on:
  push:
    branches: [Docker-build-test-GH-action]
  workflow_dispatch:

jobs:
  Docker-build:
    runs-on: ubuntu-latest
    timeout-minutes: 15

    env:
      GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}

    steps:
      - name: Checkout workflow.transition.monitor
        uses: actions/checkout@v3
        with:
          path: workflow.transition.monitor

      - name: Checkout pacta.portfolio.import
        uses: actions/checkout@v3
        with:
          repository: RMI-PACTA/pacta.portfolio.import
          token: ${{ secrets.GITHUB_TOKEN }}
          path: pacta.portfolio.import

      - name: Checkout pacta.portfolio.analysis
        uses: actions/checkout@v3
        with:
          repository: RMI-PACTA/pacta.portfolio.analysis
          token: ${{ secrets.PAT_ADD_ISSUES_TO_PROJECT }}
          path: pacta.portfolio.analysis

      - name: Checkout pacta.interactive.report
        uses: actions/checkout@v3
        with:
          repository: RMI-PACTA/pacta.interactive.report
          token: ${{ secrets.PAT_ADD_ISSUES_TO_PROJECT }}
          path: pacta.interactive.report

      - name: Checkout pacta.executive.summary
        uses: actions/checkout@v3
        with:
          repository: RMI-PACTA/pacta.executive.summary
          token: ${{ secrets.GITHUB_TOKEN }}
          path: pacta.executive.summary

      - name: Make fake (empty) pacta-data folder
        run: mkdir pacta-data; touch pacta-data/test.txt
        shell: bash

      - name: List files and directories in working directory
        run: ls -al
        shell: bash

      - name: Build Docker image
        run: docker build workflow.transition.monitor/
        shell: bash
